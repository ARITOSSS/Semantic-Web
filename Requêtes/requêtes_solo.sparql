#REQUETE 1

PREFIX dbr: <http://dbpedia.org/resource/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX dbo: <http://dbpedia.org/ontology/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX schema: <https://schema.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?city (COUNT(?transaction) as ?numTransactions)
WHERE {
  ?transaction a schema:PurchaseAction;
  			schema:location ?loc .
  ?loc schema:name ?city.
}
GROUP BY ?city
ORDER BY DESC(?numTransactions)
LIMIT 10

# REQUETE 2

PREFIX dbr: <http://dbpedia.org/resource/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX dbo: <http://dbpedia.org/ontology/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX schema: <https://schema.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?memberTier (COUNT(?transaction) as ?numTransactions)
WHERE {
  ?transaction a schema:PurchaseAction;
  			schema:customer ?cust .
  ?cust schema:memberTier ?memberTier.
}
GROUP BY ?memberTier
ORDER BY DESC(?numTransactions)
LIMIT 10

# REQUETE 3

PREFIX dbr: <http://dbpedia.org/resource/>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX dcterms: <http://purl.org/dc/terms/>
PREFIX dbo: <http://dbpedia.org/ontology/>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX schema: <https://schema.org/>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>

SELECT ?category (COUNT(?tx) as ?fraudCount)
WHERE {
  ?tx a schema:PurchaseAction;
  			schema:productCategory ?category .
}
GROUP BY ?category
ORDER BY DESC(?fraudCount)
